title: "about 0X0d0a"
date: 2015-05-09 18:03:51
tags:
- 0X0d0a
categories: skill
feature: /images/mainmenu/083.jpg
description: 对未来感到不安的时候,静静看书吧!
toc: true
---
#### 现象 ####
使用libcurl http方式从[网络](http://www.winrar.com.cn/download/winrar-x64-521sc.exe)下载到内存,然后写入本地文件.文件下载完在内存中Total: 2037448 bytes retrieved.写入本地文件就变成2044975 bytes.
#### 思路 ####
{% raw %}
Server -> MEM -> FILE
{% endraw %}
用其他下载器下载文件,查看文件信息,确认到内存为止是OK的.
对比文件和程序中得到的文件,查看差异,找出差异的规律.
{% img http://7vztq1.com1.z0.glb.clouddn.com/2015/0X0D0A/bey_compare1.png [十六进制差异图 [#1] %}如图:每个0A(LF)前面多了一个0D(CR).{% textcolor danger %}warning: LF will be replaced by CRLF{% endtextcolor %}<!-- more -->
#### 障碍 ####
其实是fopen打开参数选项上很小的一个细节,但是以前一直工作在嵌入式Linux环境下,限制了思维,对这个现象不够敏感.
#### 总结 ####
Windows的回车换行编码是0x0d 0x0a,而Linux的编码是0x0a.
所以在Linux下,文件以文本或者二进制方式读写都是一样的.
在Win环境下,wb是二进制方式打开文件.
w是以文本方式打开文件,此时,fwrite函数每碰到一个0x0A,就在它前面插入0x0D.
#### 复习 ####
1.fopen --> open --> file_operations --> system_call --> unistd_64.h
{% img http://7vztq1.com1.z0.glb.clouddn.com/2015/0X0D0A/open_fopen_param.png [open&&fopen PARAM [#1] %}